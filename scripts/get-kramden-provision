#!/bin/bash

set -euo pipefail

REPO_URL="https://github.com/kramden/kramden-provision.git"
REPO_DIR="kramden-provision"

if ! command -v git &>/dev/null; then
    echo "âŒ Error: git is not installed." >&2
    exit 1
fi

if [ -d "$REPO_DIR" ]; then
    echo "ðŸ“‚ Directory '$REPO_DIR' already exists. Pulling latest changes..."
    if ! git -C "$REPO_DIR" pull; then
        echo "âŒ Error: failed to pull updates in '$REPO_DIR'." >&2
        exit 1
    fi
    echo "âœ… Done: $PWD/$REPO_DIR is up to date."
else
    echo "ðŸ“¦ Cloning kramden-provision..."
    if ! git clone "$REPO_URL"; then
        echo "âŒ Error: failed to clone $REPO_URL." >&2
        exit 1
    fi
    echo "âœ… Done: kramden-provision cloned to $PWD/$REPO_DIR"
fi
